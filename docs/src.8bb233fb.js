parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"XeAP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={terrainTypes:{Nrm:0,Mnt:1,Wtr:2,Wll:3},buttons:{TurnEnd:0,Wait:1},gameResult:{None:0,Win:1,Lose:2}},t=e;exports.default=t;
},{}],"EGTA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("/src/consts"));function e(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}var s=0,u=1,a=2,l=3,c=function(){function e(t,i){n(this,e),this.hGame=t,this.isEnemy=i,this.ctrlState=s,this.currentButtonID=null,this.currentUnit=null,this.currentDest=null,this.currentTarget=null}return r(e,[{key:"stateDeselect",value:function(){this.currentUnit.eventDeselect(),this.currentUnit=null,null!==this.currentTarget&&(this.currentTarget.eventStopBeingTargeted(),this.currentTarget=null),this.ctrlState=s}},{key:"stateConfirmDestination",value:function(t){this.currentDest=t,this.ctrlState=a,this.currentUnit.eventProposeDestination(t)}},{key:"stateClearButton",value:function(){this.currentButtonID=null}},{key:"stateConfirmTarget",value:function(t){this.ctrlState=l,this.currentTarget=t,this.currentUnit.eventProposeTarget(t),t.eventBeTargeted()}},{key:"clickButton",value:function(e){if(e===t.default.buttons.TurnEnd){if(this.ctrlState===s||this.ctrlState===u)return null===this.currentButtonID?(this.currentButtonID=e,null!==this.currentUnit&&this.stateDeselect(),!0):this.currentButtonID===t.default.buttons.TurnEnd?(this.hGame.eventButtonTurnEnd(),this.stateClearButton(),!0):(this.stateClearButton(),!1);this.stateClearButton()}else if(e===t.default.buttons.Wait){if(this.ctrlState===u)return null===this.currentButtonID?(this.currentButtonID=e,!0):this.currentButtonID===t.default.buttons.Wait?(this.currentUnit.eventExecuteWait(),this.stateDeselect(),this.stateClearButton(),!0):(this.stateClearButton(),!1);this.stateClearButton()}return!1}},{key:"clickGP",value:function(t){if(t.x<1||t.x>this.hGame.maxGrid.x||t.y<1||t.y>this.hGame.maxGrid.y)return!1;if(this.stateClearButton(),this.ctrlState===s){null!==this.currentUnit&&(this.currentUnit.eventDeselect(),this.currentUnit=null);var e=this.hGame.findSelfUnitByGridPos(this.isEnemy,t);if(null!==e?(e.isActive()&&(this.ctrlState=u),this.currentUnit=e,e.eventSelect()):null!==(e=this.hGame.findOppoUnitByGridPos(this.isEnemy,t))&&(this.currentUnit=e,e.eventSelect()),null===e)return this.ctrlState=s,!1}else{if(this.ctrlState===u){var n=this.hGame.findUnitByGridPos(t);return null===n&&this.currentUnit.checkMoveDestination(t)?(this.stateConfirmDestination(t),!0):null!==n&&n.isEnemy!==this.isEnemy&&this.currentUnit.checkAttackTarget(n,this.currentUnit.gridPos)?(h("selected an eligible target during dest proposition"),this.stateConfirmDestination(this.currentUnit.gridPos),this.stateConfirmTarget(n),!0):(h("invalid destination"),this.stateDeselect(),!1)}if(this.ctrlState===a){var i=this.hGame.findUnitByGridPos(t);return null===i&&t.x===this.currentDest.x&&t.y===this.currentDest.y?(this.currentUnit.eventExecuteMovement(t),this.stateDeselect(),!0):null!==i&&i.isEnemy!==this.isEnemy&&this.currentUnit.checkAttackTarget(i,this.currentDest)?(this.stateConfirmTarget(i),!0):(this.stateDeselect(),!1)}if(this.ctrlState===l)return t.x===this.currentTarget.gridPos.x&&t.y===this.currentTarget.gridPos.y?(this.currentUnit.eventExecuteAttack(this.currentTarget),this.stateDeselect(),!0):(this.stateDeselect(),!1)}return h("this alert should not happen due to returns. x: "+t.x+", y: "+t.y+";  ctrl state: "+this.ctrlState),!0}}]),e}();function h(t){}exports.default=c;
},{"/src/consts":"XeAP"}],"vIAZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("./abstractController"));function e(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}var s=function(){function e(n){var o=this;i(this,e),this.hGame=n,this.hCanvas=n.hCanvas,this.abstractController=new t.default(n,!1),this.clickPosQueue=[],this.isMobile=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),this.isApple=/iPhone|iPad|iPod/i.test(navigator.userAgent);var s=this.isMobile?"touchstart":"click";document.addEventListener(s,function(t){o.mouseClick(o.getMousePosWithinCanvas(t)),o.isMobile&&t.preventDefault()}),this.isMobile&&(document.addEventListener("touchmove",function(t){t.preventDefault()}),document.addEventListener("touchend",function(t){t.preventDefault()}))}return o(e,[{key:"getMousePosWithinCanvas",value:function(t){void 0!==t.touches&&(t=t.touches[0]);var e=this.hCanvas.getBoundingClientRect();return{x:(t.clientX-e.left)/(e.right-e.left)*this.hCanvas.width,y:(t.clientY-e.top)/(e.bottom-e.top)*this.hCanvas.height}}},{key:"mouseClick",value:function(t){this.hGame.isPhaseBlocked||this.hGame.currentPhase===this.hGame.PHASE_PLAYER&&this.clickPosQueue.push(t)}},{key:"update",value:function(t){for(;t>0&&this.clickPosQueue.length>0;){t--;var e=this.clickPosQueue.shift();e.x<=this.hGame.gameWidth&&e.y<=this.hGame.gameHeight?this.abstractController.clickGP(this.hGame.posToGridPos(e)):this.abstractController.clickButton(this.hGame.findButton(e))}}}]),e}();exports.default=s;
},{"./abstractController":"EGTA"}],"iHGx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("/src/consts"));function e(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function a(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}var o=t.default.terrainTypes,h=function(){function t(e,s,a,o,h){i(this,t),this.unitID=e,this.image=document.getElementById(h),this.hGame=s,this.gridPos=a,this.coordinate=s.gridPosToPos(a),this.imageSize={x:s.gridSize,y:s.gridSize},this.isEnemy=o,this.hp=1,this.attack=255,this.alive=!0,this.stamina=0,this.staminaMax=1,this.moveDist=0,this.moveDistMax=2,this.attackRange=1,this.pathData=null,this.resetControlState(),this.resetProposal()}return a(t,[{key:"resetControlState",value:function(){this.drawScale=1,this.isSelected=!1,this.isTargeted=!1}},{key:"resetProposal",value:function(){this.hasDestProposal=!1,this.destProposalGP=null,this.destProposalCoord=null,this.pathToDestProposal=null,this.pathToDestProposalCoord=null,this.hasTargetProposal=!1,this.targetProposal=null,this.isTargeted=!1}},{key:"isActive",value:function(){return!(this.stamina<=0)}},{key:"eventNewTurn",value:function(){this.stamina=this.staminaMax,this.moveDist=this.moveDistMax,this.updatePathData()}},{key:"eventSenjoUpdated",value:function(){this.updatePathData()}},{key:"updatePathData",value:function(){this.pathData=this.hGame.pathFinder.floodFill(this,this.gridPos,this.moveDist)}},{key:"eventSelect",value:function(){this.isSelected=!0,this.drawScale=1.15}},{key:"eventDeselect",value:function(){this.resetControlState(),this.resetProposal()}},{key:"checkPassable",value:function(t){return!(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&null!==this.hGame.findOppoUnitByGridPos(this.isEnemy,t))&&this.hGame.stage.getTerrain(t.x,t.y)===o.Nrm}},{key:"checkMoveDestination",value:function(t){return!(Math.abs(t.x-this.gridPos.x)+Math.abs(t.y-this.gridPos.y)>this.moveDistMax)&&!!this.hGame.pathFinder.isReachable(this.pathData,t)}},{key:"acceptPath",value:function(t){this.pathToDestProposal=t,this.pathToDestProposalCoord=[t.length];for(var e=t.length,i=0;i<e;i++)this.pathToDestProposalCoord[i]=this.hGame.gridPosToPos(t[i])}},{key:"eventProposeDestination",value:function(t){this.hasDestProposal=!0,this.destProposalGP=t,this.destProposalCoord=this.hGame.gridPosToPos(t),this.acceptPath(this.hGame.pathFinder.retrievePath(this.pathData,this.gridPos,t))}},{key:"executeAction",value:function(){this.stamina--,this.resetProposal(),this.hGame.eventActionExecuted()}},{key:"eventExecuteMovement",value:function(){this.gridPos=this.destProposalGP,this.coordinate=this.hGame.gridPosToPos(this.gridPos),this.executeAction()}},{key:"checkAttackTarget",value:function(t,e){return Math.abs(t.gridPos.x-e.x)+Math.abs(t.gridPos.y-e.y)===this.attackRange}},{key:"eventProposeTarget",value:function(t){this.targetProposal=t,this.hasTargetProposal=!0}},{key:"eventBeTargeted",value:function(){this.isTargeted=!0}},{key:"eventStopBeingTargeted",value:function(){this.isTargeted=!1}},{key:"eventExecuteAttack",value:function(t){this.gridPos=this.destProposalGP,this.coordinate=this.hGame.gridPosToPos(this.gridPos),this.hGame.eventBattle(this,t),this.executeAction()}},{key:"eventExecuteWait",value:function(){this.executeAction()}},{key:"eventLoseHP",value:function(t){this.hp-=t,this.hp<=0&&(this.alive=!1,this.hGame.eventUnitDeath(this))}},{key:"isInPhase",value:function(){return this.isEnemy===(this.hGame.currentPhase===this.hGame.PHASE_ENEMY)}},{key:"update",value:function(t){}},{key:"drawUnitBG",value:function(t){if(this.isSelected||this.isTargeted?this.isEnemy?t.fillStyle="rgba(255,85,85,0.9)":t.fillStyle="rgba(136,136,238,0.9)":this.isActive()||!this.isInPhase()?this.isEnemy?t.fillStyle="rgba(255,140,140,0.8)":t.fillStyle="rgba(170,170,255,0.8)":this.isEnemy?t.fillStyle="rgba(255,238,238,0.8)":t.fillStyle="rgba(238,238,255,0.8)",t.fillRect(this.coordinate.x-.45*this.imageSize.x,this.coordinate.y-.45*this.imageSize.y,.9*this.imageSize.x,.9*this.imageSize.y),this.hasDestProposal){if(null!==this.pathToDestProposal){this.isEnemy?t.fillStyle="rgba(255,170,170,0.7)":t.fillStyle="rgba(170,204,255,0.7)";for(var e=this.pathToDestProposal.length,i=1;i<e;i++)t.fillRect(this.pathToDestProposalCoord[i].x-.45*this.imageSize.x,this.pathToDestProposalCoord[i].y-.45*this.imageSize.y,.9*this.imageSize.x,.9*this.imageSize.y)}this.isEnemy?t.fillStyle="#e88":t.fillStyle="#88e",t.fillRect(this.destProposalCoord.x-.45*this.imageSize.x,this.destProposalCoord.y-.45*this.imageSize.y,.9*this.imageSize.x,.9*this.imageSize.y)}}},{key:"drawUnit",value:function(t){this.hasDestProposal?t.drawImage(this.image,this.destProposalCoord.x-this.imageSize.x*this.drawScale/2,this.destProposalCoord.y-this.imageSize.y*this.drawScale/2,this.imageSize.x*this.drawScale,this.imageSize.y*this.drawScale):t.drawImage(this.image,this.coordinate.x-this.imageSize.x*this.drawScale/2,this.coordinate.y-this.imageSize.y*this.drawScale/2,this.imageSize.x*this.drawScale,this.imageSize.y*this.drawScale)}}]),t}();exports.default=h;
},{"/src/consts":"XeAP"}],"t2Tn":[function(require,module,exports) {
"use strict";function i(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function t(i,t){for(var e=0;e<t.length;e++){var l=t[e];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(i,l.key,l)}}function e(i,e,l){return e&&t(i.prototype,e),l&&t(i,l),i}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var l=function(){function t(e,l){i(this,t),this.gridSize=e,this.xMax=l.x,this.yMax=l.y,this.lineHalfWidth=1}return e(t,[{key:"draw",value:function(i){i.fillStyle="#03f";for(var t=0;t<=this.xMax;t++)i.fillRect(t*this.gridSize-this.lineHalfWidth,0-this.lineHalfWidth,2*this.lineHalfWidth,this.yMax*this.gridSize+2*this.lineHalfWidth);for(var e=0;e<=this.yMax;e++)i.fillRect(0-this.lineHalfWidth,e*this.gridSize-this.lineHalfWidth,this.xMax*this.gridSize+2*this.lineHalfWidth,2*this.lineHalfWidth)}}]),t}();exports.default=l;
},{}],"s0jB":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function i(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var a=function(){function t(i,a){e(this,t),this.frame=1,this.maxFrame=100,this.isEnemyPhase=a,this.image=a?document.getElementById("img_effect_EP"):document.getElementById("img_effect_PP"),this.drawX=i.gameWidth+i.gridSize+20,this.drawY=i.gridSize*i.maxGrid.y/2-this.image.height/2,this.hGame=i}return i(t,[{key:"update",value:function(e){this.frame+=e,this.drawX-=18.75*e,this.frame>this.maxFrame&&this.hGame.eventEffectEnd(this)}},{key:"draw",value:function(e){this.frame<=this.maxFrame&&e.drawImage(this.image,this.drawX,this.drawY)}}]),t}();exports.default=a;
},{}],"KO80":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("/src/abstractController")),i=e(require("/src/consts"));function e(t){return t&&t.__esModule?t:{default:t}}function s(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function n(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function a(t,i,e){return i&&n(t.prototype,i),e&&n(t,e),t}var o=[0,-1,1,0],r=[1,0,0,-1],c=function(){function e(i,n){s(this,e),this.hGame=i,this.isEnemy=n,this.isEnemy?(this.suList=i.enemyUnitList,this.ouList=i.playerUnitList):(this.suList=i.playerUnitList,this.ouList=i.enemyUnitList),this.absCon=new t.default(this.hGame,n),this.blockFrameRemain=0,this.blockFramePerAttack=18,this.blockFramePerMove=18,this.blockFramePerWait=5}return a(e,[{key:"executeWait",value:function(t){this.absCon.clickGP(t.gridPos),this.absCon.clickButton(i.default.buttons.Wait),this.absCon.clickButton(i.default.buttons.Wait),this.blockFrameRemain=this.blockFramePerWait}},{key:"executeMove",value:function(t,i){this.absCon.clickGP(t.gridPos),this.absCon.clickGP(i),this.absCon.clickGP(i),this.blockFrameRemain=this.blockFramePerMove}},{key:"executeMoveAttack",value:function(t,i,e){this.absCon.clickGP(t.gridPos),i.x===t.gridPos.x&&i.y===t.gridPos.y?(this.absCon.clickGP(e.gridPos),this.absCon.clickGP(e.gridPos)):(this.absCon.clickGP(i),this.absCon.clickGP(e.gridPos),this.absCon.clickGP(e.gridPos)),this.blockFrameRemain=this.blockFramePerAttack}},{key:"findOppoUnitAndAttack",value:function(t){var i=this,e=this.suList[t];return e.pathData.listPossibleDest.forEach(function(t){for(var s=0;s<4;s++){var n=i.hGame.findOppoUnitByGridPos(i.isEnemy,{x:t.x+o[s],y:t.y+r[s]});if(null!==n)return i.executeMoveAttack(e,t,n),!0}}),!1}},{key:"tryGetClose",value:function(t){var i=this,e=this.suList[t];if(0===e.pathData.listPossibleDest.length)return!1;var s=1e4,n=null;return e.pathData.listPossibleDest.forEach(function(t){if(null===i.hGame.findSelfUnitByGridPos(i.isEnemy,t)){var a=i.hGame.pathFinder.floodFill(e,t,300,!0);i.ouList.forEach(function(i){var e=a.dist[i.gridPos.x][i.gridPos.y];e<s&&(s=e,n=t)})}}),null!==n&&(this.executeMove(e,n),!0)}},{key:"makeOneMove",value:function(){var t=0,i=this.suList.length;for(t=0;t<i;t++)if(this.suList[t].stamina>0){var e=this.findOppoUnitAndAttack(t);return!1===e&&(e=this.tryGetClose(t)),void(!1===e&&this.executeWait(this.suList[t]))}}},{key:"update",value:function(t){this.blockFrameRemain-=t,this.blockFrameRemain<=0&&this.makeOneMove()}}]),e}();exports.default=c;
},{"/src/abstractController":"EGTA","/src/consts":"XeAP"}],"ZdXk":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var i=[0,-1,1,0],a=[1,0,0,-1],n=1e5,s=function(){function e(r){t(this,e),this.hGame=r,this.maxGrid=r.maxGrid,this.eList=r.enemyUnitList,this.pList=r.playerUnitList,this.hStage=r.stage,this.visited=null,this.path=null}return r(e,[{key:"floodFill",value:function(t,e,r){for(var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=[this.maxGrid.x+1],o=[this.maxGrid.x+1],u=1;u<=this.maxGrid.x;u++){l[u]=[this.maxGrid.y+1],o[u]=[this.maxGrid.y+1];for(var h=1;h<=this.maxGrid.y;h++)o[u][h]=n,l[u][h]=null}var v=[],f=1,x=0;v[f]=e,l[e.x][e.y]=e,o[e.x][e.y]=0;var y=[];for(y.push(e);f>x;)if(!(o[v[++x].x][v[x].y]>=r))for(var d=0;d<4;d++){var c=v[x].x+i[d],m=v[x].y+a[d];if(c>=1&&c<=this.maxGrid.x&&m>=1&&m<=this.maxGrid.y&&o[c][m]===n){var p={x:c,y:m};t.checkPassable(p,s)&&(v[++f]=p,o[c][m]=o[v[x].x][v[x].y]+1,l[c][m]=v[x],y.push(p))}}return{prev:l,dist:o,listPossibleDest:y}}},{key:"isReachable",value:function(t,e){return t.dist[e.x][e.y]!==n}},{key:"retrievePath",value:function(t,e,r){var i=t.prev;if(null!==i[r.x][r.y]){for(var a=r.x,n=r.y,s=0;a!==e.x||n!==e.y;){s++;var l=i[a][n].x;n=i[a][n].y,a=l}var o=[s];a=r.x,n=r.y;for(var u=0;u<s;u++){o[s-u-1]=i[a][n];var h=i[a][n].x;n=i[a][n].y,a=h}return o}return null}},{key:"findPath",value:function(t,e,r){var i=this.floodFill(t,e,t.moveDist);return this.retrievePath(i,e,r)}}]),e}();exports.default=s;
},{}],"iEAz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("/src/consts"));function t(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}var n=e.default.terrainTypes,s=function(){function e(t,a,r){i(this,e),this.maxGrid=t,this.terrainMap=a,this.unitList=r,this.imageCache=[],this.hGame=null}return r(e,[{key:"initStage",value:function(e){this.hGame=e,this.unitList.forEach(function(t){0===t.appearTurn&&e.eventPlaceUnit(t.gridPos,t.isEnemy,t.image)}),this.imageCache[n.Nrm]=document.getElementById("img_terrain_grass"),this.imageCache[n.Mnt]=document.getElementById("img_terrain_yama"),this.imageCache[n.Wtr]=document.getElementById("img_terrain_kawa")}},{key:"endTurn",value:function(e){this.unitList.forEach(function(t){t.appearTurn===e.turn&&t.isEnemy===(e.currentPhase===e.PHASE_ENEMY)&&e.eventPlaceUnit(t.gridPos,t.isEnemy,t.image)})}},{key:"getTerrain",value:function(e,t){return this.terrainMap[t-1][e-1]}},{key:"update",value:function(e){}},{key:"draw",value:function(e){for(var t=1;t<=this.maxGrid.x;t++)for(var i=1;i<=this.maxGrid.y;i++){var a=this.hGame.gridPosToPos({x:t,y:i});e.drawImage(this.imageCache[this.getTerrain(t,i)],a.x-this.hGame.gridSize/2,a.y-this.hGame.gridSize/2,this.hGame.gridSize,this.hGame.gridSize)}}}]),e}();exports.default=s;
},{"/src/consts":"XeAP"}],"wia5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=e(require("/src/stage")),m=e(require("/src/consts"));function e(r){return r&&r.__esModule?r:{default:r}}var i=m.default.terrainTypes,n={x:6,y:8},s=[[i.Nrm,i.Mnt,i.Mnt,i.Nrm,i.Nrm,i.Nrm],[i.Nrm,i.Nrm,i.Nrm,i.Nrm,i.Nrm,i.Nrm],[i.Nrm,i.Nrm,i.Nrm,i.Nrm,i.Nrm,i.Wtr],[i.Nrm,i.Nrm,i.Nrm,i.Wtr,i.Nrm,i.Mnt],[i.Nrm,i.Wtr,i.Nrm,i.Wtr,i.Nrm,i.Mnt],[i.Nrm,i.Wtr,i.Nrm,i.Nrm,i.Nrm,i.Nrm],[i.Nrm,i.Nrm,i.Nrm,i.Nrm,i.Nrm,i.Nrm],[i.Nrm,i.Nrm,i.Nrm,i.Mnt,i.Mnt,i.Nrm]],a=[{gridPos:{x:2,y:7},appearTurn:0,isEnemy:!1,image:"img_kenshi"},{gridPos:{x:3,y:7},appearTurn:0,isEnemy:!1,image:"img_kenshi"},{gridPos:{x:4,y:7},appearTurn:0,isEnemy:!1,image:"img_kenshi"},{gridPos:{x:5,y:7},appearTurn:0,isEnemy:!1,image:"img_kenshi"},{gridPos:{x:1,y:1},appearTurn:0,isEnemy:!0,image:"img_kenshi2"},{gridPos:{x:3,y:2},appearTurn:0,isEnemy:!0,image:"img_kenshi2"},{gridPos:{x:4,y:1},appearTurn:0,isEnemy:!0,image:"img_kenshi2"},{gridPos:{x:3,y:4},appearTurn:0,isEnemy:!0,image:"img_kenshi2"},{gridPos:{x:5,y:2},appearTurn:0,isEnemy:!0,image:"img_kenshi2"}],N=new r.default(n,s,a);exports.default=N;
},{"/src/stage":"iEAz","/src/consts":"XeAP"}],"w9XJ":[function(require,module,exports) {
"use strict";function e(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function i(e,i){for(var t=0;t<i.length;t++){var a=i[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function t(e,t,a){return t&&i(e.prototype,t),a&&i(e,a),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var a=10,s=function(){function i(t,a,s,r){e(this,i),this.hGame=t,this.img=document.getElementById(a),this.buttonID=s,this.drawGP=r,this.pos=this.hGame.gridPosToPos(r),this.drawScale=1,this.drawScaleMax=1}return t(i,[{key:"checkClick",value:function(e){return e.x>=a+this.pos.x-this.hGame.gridSize*this.drawScale*.5&&e.y>=this.pos.y-this.hGame.gridSize*this.drawScale*.5&&e.x<=a+this.pos.x+this.hGame.gridSize*this.drawScale*.5&&e.y<=this.pos.y+this.hGame.gridSize*this.drawScale*.5}},{key:"eventClick",value:function(){this.drawScale=.7}},{key:"update",value:function(e){this.drawScale<this.drawScaleMax&&(this.drawScale=Math.min(this.drawScale+.02*e,this.drawScaleMax))}},{key:"draw",value:function(e){e.drawImage(this.img,a+this.pos.x-this.hGame.gridSize*this.drawScale*.5,this.pos.y-this.hGame.gridSize*this.drawScale*.5,this.hGame.gridSize*this.drawScale,this.hGame.gridSize*this.drawScale)}}]),i}();exports.default=s;
},{}],"HPsM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=h(require("/src/unitBase")),e=h(require("/src/grid")),i=h(require("/src/effects/effectStartPhase")),n=h(require("/src/enemyAI")),s=h(require("/src/pathFinder")),r=h(require("/src/stages/stage01")),a=h(require("/src/consts")),u=h(require("/src/button"));function h(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,i){return e&&f(t.prototype,e),i&&f(t,i),t}var l=function(){function h(t,i,r){o(this,h),this.PHASE_NONE=0,this.PHASE_PLAYER=1,this.PHASE_ENEMY=2,this.gameWidth=t,this.gameHeight=i,this.hCanvas=r,this.maxGrid={x:6,y:8},this.gridSize=t/this.maxGrid.x,this.grid=new e.default(this.gridSize,this.maxGrid),this.playerUnitList=[],this.enemyUnitList=[],this.unitID=0,this.effectList=[],this.totalActiveStamina=0,this.currentPhase=this.PHASE_NONE,this.isPhaseBlocked=!1,this.framesBeforeChangePhase=0,this.turn=0,this.stage=null,this.enemyAI=new n.default(this,!0),this.pathFinder=new s.default(this),this.gameResult=a.default.gameResult.None,this.buttonList=[],this.makeButtons()}return c(h,[{key:"makeButtons",value:function(){this.buttonList.push(new u.default(this,"img_button_wait",a.default.buttons.Wait,{x:7,y:1})),this.buttonList.push(new u.default(this,"img_button_turn_end",a.default.buttons.TurnEnd,{x:7,y:2}))}},{key:"bindPlayerInputHandler",value:function(t){this.playerInputHandler=t}},{key:"eventPlaceUnit",value:function(e,i,n){this.unitID++,i?this.enemyUnitList.push(new t.default(this.unitID,this,e,i,n)):this.playerUnitList.push(new t.default(this.unitID,this,e,i,n))}},{key:"start",value:function(){this.stage=r.default,this.stage.initStage(this),this.playerPhase()}},{key:"eventActionExecuted",value:function(){this.totalActiveStamina--,this.totalActiveStamina<=0&&this.endPhase(),this.currentPhase===this.PHASE_PLAYER?this.playerUnitList.forEach(function(t){return t.eventSenjoUpdated()}):this.currentPhase===this.PHASE_ENEMY&&this.enemyUnitList.forEach(function(t){return t.eventSenjoUpdated()})}},{key:"eventButtonTurnEnd",value:function(){(this.currentPhase===this.PHASE_PLAYER?this.playerUnitList:this.enemyUnitList).forEach(function(t){t.isActive()&&t.eventExecuteWait()})}},{key:"playerPhase",value:function(){var t=this;this.turn++,this.currentPhase=this.PHASE_PLAYER,this.totalActiveStamina=0,this.playerUnitList.forEach(function(e){e.eventNewTurn(),t.totalActiveStamina+=e.stamina})}},{key:"enemyPhase",value:function(){var t=this;this.currentPhase=this.PHASE_ENEMY,this.totalActiveStamina=0,this.enemyUnitList.forEach(function(e){e.eventNewTurn(),t.totalActiveStamina+=e.stamina})}},{key:"endPhase",value:function(){this.stage.endTurn(this),this.framesBeforeChangePhase=80,this.isPhaseBlocked=!0,this.currentPhase===this.PHASE_PLAYER?this.effectList.push(new i.default(this,!0)):this.effectList.push(new i.default(this,!1))}},{key:"procChangePhase",value:function(t){this.framesBeforeChangePhase-=t,this.framesBeforeChangePhase<=0&&(this.isPhaseBlocked=!1,this.currentPhase===this.PHASE_PLAYER?this.enemyPhase():this.currentPhase===this.PHASE_ENEMY&&this.playerPhase())}},{key:"findUnitInListByGridPos",value:function(t,e){for(var i=t.length,n=0;n<i;n++)if(t[n].gridPos.x===e.x&&t[n].gridPos.y===e.y)return t[n];return null}},{key:"findPlayerUnitByGridPos",value:function(t){return this.findUnitInListByGridPos(this.playerUnitList,t)}},{key:"findEnemyUnitByGridPos",value:function(t){return this.findUnitInListByGridPos(this.enemyUnitList,t)}},{key:"findSelfUnitByGridPos",value:function(t,e){return t?this.findEnemyUnitByGridPos(e):this.findPlayerUnitByGridPos(e)}},{key:"findOppoUnitByGridPos",value:function(t,e){return t?this.findPlayerUnitByGridPos(e):this.findEnemyUnitByGridPos(e)}},{key:"findUnitByGridPos",value:function(t){var e=this.findPlayerUnitByGridPos(t);return null!==e?e:null!==(e=this.findEnemyUnitByGridPos(t))?e:null}},{key:"findButton",value:function(t){var e=null;return this.buttonList.forEach(function(i){i.checkClick(t)&&(e=i.buttonID,i.eventClick())}),e}},{key:"mouseClick",value:function(t){}},{key:"eventBattle",value:function(t,e){e.eventLoseHP(t.attack)}},{key:"eventUnitDeath",value:function(t){t.isEnemy?d(t,this.enemyUnitList):d(t,this.playerUnitList),this.enemyUnitList.length<=0?this.gameResult=a.default.gameResult.Win:this.playerUnitList.length<=0&&(this.gameResult=a.default.gameResult.Lose)}},{key:"eventEffectEnd",value:function(t){d(t,this.effectList)}},{key:"update",value:function(t){this.buttonList.forEach(function(e){return e.update(t)}),this.framesBeforeChangePhase>0&&this.procChangePhase(t),this.currentPhase===this.PHASE_ENEMY&&this.enemyAI.update(t),this.playerInputHandler.update(t),this.playerUnitList.forEach(function(e){return e.update(t)}),this.enemyUnitList.forEach(function(e){return e.update(t)}),this.effectList.forEach(function(e){return e.update(t)})}},{key:"draw",value:function(t){this.stage.draw(t),this.buttonList.forEach(function(e){return e.draw(t)}),this.grid.draw(t),this.playerUnitList.forEach(function(e){return e.drawUnitBG(t)}),this.enemyUnitList.forEach(function(e){return e.drawUnitBG(t)}),this.playerUnitList.forEach(function(e){return e.drawUnit(t)}),this.enemyUnitList.forEach(function(e){return e.drawUnit(t)}),this.effectList.forEach(function(e){return e.draw(t)}),this.gameResult,a.default.gameResult.None}},{key:"gridPosToPos",value:function(t){return{x:t.x*this.gridSize-this.gridSize/2,y:t.y*this.gridSize-this.gridSize/2}}},{key:"posToGridPos",value:function(t){return{x:Math.floor(t.x/this.gridSize)+1,y:Math.floor(t.y/this.gridSize)+1}}}]),h}();function d(t,e){var i=e.length,n=0;for(n=0;n<i&&e[n]!==t;n++);e.splice(n,1)}exports.default=l;
},{"/src/unitBase":"iHGx","/src/grid":"t2Tn","/src/effects/effectStartPhase":"s0jB","/src/enemyAI":"KO80","/src/pathFinder":"ZdXk","/src/stages/stage01":"wia5","/src/consts":"XeAP","/src/button":"w9XJ"}],"H99C":[function(require,module,exports) {
"use strict";var e=r(require("/src/inputHandler")),t=r(require("/src/game")),a=r(require("/src/consts"));function r(e){return e&&e.__esModule?e:{default:e}}var u=document.getElementById("gameScreen"),n=u.getContext("2d"),l=360,s=640,d=430,i=640,m=new t.default(l,s,u),c=new e.default(m);m.bindPlayerInputHandler(c),m.start();var o=0;function g(e){var t=e-o;o=e;var r=t/16;n.clearRect(0,0,d,i),m.update(r),m.draw(n),m.gameResult===a.default.gameResult.None?requestAnimationFrame(g):m.gameResult===a.default.gameResult.Win?alert("You win!"):m.gameResult===a.default.gameResult.Lose&&alert("GAME OVER")}requestAnimationFrame(g);
},{"/src/inputHandler":"vIAZ","/src/game":"HPsM","/src/consts":"XeAP"}]},{},["H99C"], null)
//# sourceMappingURL=src.8bb233fb.js.map